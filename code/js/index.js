async function listVoices(){let e;speechSynthesis.getVoices().forEach(((t,n)=>{e={idx:n,name:t.name,lang:t.lang,default:t.default},n++,localVoices.push(e)}));let t=languages.findIndex((e=>e.lid===activeLanguageID));localVoices.findIndex((e=>e.lang===languages[t].lngc))>-1?(document.getElementById("id-listen").style.display="flex",document.getElementById("id-brListen").style.display="block"):(document.getElementById("id-listen").style.display="none",document.getElementById("id-brListen").style.display="none")}async function getDefaults(){const e=new URLSearchParams(window.location.search);let t=localStorage.getItem("redLetter");t&&(redLetterDefault=t);let n=e.get("vh");n&&(selectedVerseID=`id-verse${n}`);let s=e.get("verid");s&&(activeVersionID=`id-version${s}`),activeVersionID||(activeVersionID=localStorage.getItem("activeVersionID")),activeVersionID||(activeVersionID=defaultVersionID);let i=Number(activeVersionID.slice("id-version".length)),a=versions.findIndex((e=>e.id===i));activeLanguageID=versions[a].lid;let d=e.get("bid");d&&(activeBookID=`id-book${d}`),activeBookID||(activeBookID=localStorage.getItem("activeBookID")),activeBookID||(activeBookID=defaultBookID);let o=e.get("cn");o&&(activeChapterID=`id-chapter${o}`),activeChapterID||(activeChapterID=localStorage.getItem("activeChapterID")),activeChapterID||(activeChapterID=defaultChapterID),setTheme=localStorage.getItem("setTheme"),activeFontSize=localStorage.getItem("activeFontSize"),activeFontSize?activeFontSize=Number(activeFontSize):activeFontSize=1.06,activeFontSizeCount=localStorage.getItem("activeFontSizeCount"),activeFontSizeCount?activeFontSizeCount=Number(activeFontSizeCount):activeFontSizeCount=0;let l=localStorage.getItem("savedLocal");return l&&(savedLocal=l),!0}async function getVersion(e=null){let t=null;e&&(t=e.target.id),t&&"id-resetDefaults"!==t||(t=activeVersionID);let n=document.getElementById(t),s=Number(n.dataset.index),i=`data/${versions[s].ar}/${versions[s].ar}Verses.json`;"TWF"===versions[s].ar?isTWF=!0:isTWF=!1;try{const e=await fetch(i);if(!e.ok)throw new Error(e.status);verses=await e.json();let t=selectedVerseID;await getChapter(),selectedVerseID=t,activeVersionID=n.id,document.getElementById("id-MenuBtn1").textContent=versions[s].ar,document.getElementById("id-headline").textContent=versions[s].t,activeVersionAbreviation=versions[s].ar,searchIndex=null}catch(e){let t=e.message;switch(e.message){case"500":t="Network fetch error: 500A!";break;case"503":t="No internet connection error: 503A!";break}alert(t)}return closeBoxes(),selectedVerseID&&(isNumeric(selectedVerseID)&&(selectedVerseID=`id-verse${selectedVerseID}`),verseHighlight(selectedVerseID)),versions[s].sch?document.getElementById("id-search").style.display="block":document.getElementById("id-search").style.display="none",versions[s].rdl?(document.getElementById("id-redLetter").style.display="block",redLetterDefault?document.getElementById("id-redLetter").textContent="Black Letter":document.getElementById("id-redLetter").textContent="Red Letter"):document.getElementById("id-redLetter").style.display="none",verses[0].pn?document.getElementById("id-paragraphLayout").style.display="block":document.getElementById("id-paragraphLayout").style.display="none",removeElements("id-searchResults"),document.getElementById("id-searchBox").textContent="",searchIndex=null,boxesAreOpen=!1,!0}async function getChapter(){let e=Number(activeBookID.slice("id-book".length)),t=Number(activeChapterID.slice("id-chapter".length)),n=verses.findIndex((n=>n.bid===e&&n.cn===t));removeElements("id-page");let s,i,a,d,o,l,r=document.createElement("h2"),c=document.getElementById("id-page");if(document.getElementById("id-MenuBtn2").textContent=document.getElementById(activeBookID).textContent,r.textContent=`${document.getElementById(activeBookID).textContent} ${t}`,document.getElementById("id-bottomTitleLine").textContent=r.textContent,isTWF){let e=document.createElement("span");e.classList.add("cs-edited"),e.textContent=` TWF - Last Edited: ${dateEdited}`,r.appendChild(e)}for(c.appendChild(r),verseCount=0;n<verses.length&&verses[n].cn===t&&verses[n].bid===e;){if(s=document.createElement("p"),s.id=`id-p${verses[n].vid}`,i=verses[n].pn,i>0&&paragraphLayoutDefault)for(;verses[n].pn===i;){a=document.createElement("span"),a.id=`id-versNumber${verses[n].vn}`,l=1===verses[n].vn?`${verses[n].vn} `:` ${verses[n].vn} `;let e=verses[n].vt;1===verses[n].jq?a.innerHTML=JesusQuote(e,l):(d=document.createElement("span"),d.classList.add("cs-verseNumber"),d.textContent=l,o=document.createTextNode(e),a.appendChild(d),a.appendChild(o)),s.appendChild(a),n++,verseCount++}else{a=document.createElement("span"),a.id=`id-versNumber${verses[n].vn}`,l=`${verses[n].vn} `;let e=verses[n].vt;1===verses[n].jq?a.innerHTML=JesusQuote(e,l):(d=document.createElement("span"),d.classList.add("cs-verseNumber"),d.textContent=l,o=document.createTextNode(e),a.appendChild(d),a.appendChild(o)),s.classList.add("cs-singleVerse"),s.appendChild(a),n++,verseCount++}c.appendChild(s)}loadVerses(),document.getElementById("id-bottomLastLine").style.visibility=1===e&&1===t?"hidden":"visible",document.getElementById("id-bottomNextLine").style.visibility=66===e&&22===t?"hidden":"visible",setFontSize(),document.getElementById("id-MenuBtn3").textContent=`${document.getElementById(activeChapterID).textContent}:`}window.addEventListener("load",(async()=>{let e=!1;e=await getDefaults(),e&&(e=!1,e=await loadLanguages()),e&&(e=!1,e=await loadVersions()),e&&(e=!1,e=await loadBooks()),e&&(e=!1,e=await loadChapters(),allLoaded=!0),e&&(e=!1,e=await getVersion()),e&&allLoaded&&(locateBox("id-header","id-mainPage",-10),setTimeout((()=>{document.getElementById("id-loader").style.display="none",document.getElementById("id-readRandom").style.display="block",bookWidth()}),130)),e&&("1"===setTheme&&(darkTheme(),toggleTheme(),rotateTheme=!1),savedLocal||(document.getElementById("id-end").style.display="block"),startUp()),window.addEventListener("resize",adjustPosition),"speechSynthesis"in window&&(void 0!==speechSynthesis.onvoiceschanged?speechSynthesis.onvoiceschanged=listVoices:listVoices())}));