const stopwords=new Set(["a","about","above","after","again","against","all","am","an","and","any","are","aren't","as","at","be","because","been","before","being","below","between","both","but","by","can't","cannot","could","couldn't","did","didn't","do","does","doesn't","doing","don't","down","during","each","few","for","from","further","had","hadn't","has","hasn't","have","haven't","having","he","he'd","he'll","he's","her","here","here's","hers","herself","him","himself","his","how","how's","i","i'd","i'll","i'm","i've","if","in","into","is","isn't","it","it's","its","itself","let's","me","more","most","mustn't","my","myself","no","nor","not","of","off","on","once","only","or","other","ought","our","ours","ourselves","out","over","own","same","shan't","she","she'd","she'll","she's","should","shouldn't","so","some","such","than","that","that's","the","their","theirs","them","themselves","then","there","there's","these","they","they'd","they'll","they're","they've","this","those","through","to","too","under","until","up","very","was","wasn't","we","we'd","we'll","we're","we've","were","weren't","what","what's","when","when's","where","where's","which","while","who","who's","whom","why","why's","with","won't","would","wouldn't","you","you'd","you'll","you're","you've","your","yours","yourself","yourselves"]),stemmer=e=>e.toLowerCase();function setCursorToEnd(e){const t=document.createRange(),n=window.getSelection();t.selectNodeContents(e),t.collapse(!1),n.removeAllRanges(),n.addRange(t),e.focus()}function searchFocus(){let e=document.getElementById("id-searchBox");const t=new KeyboardEvent("keypress",{key:" "});e.dispatchEvent(t),setCursorToEnd(e)}function searchKeyDown(){"Enter"===this.event.key&&(this.event.preventDefault(),searcher())}function openSearch(e=null){if(e&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()),closeBoxes(),searchOpen)return document.getElementById("id-searchContainer").style.display="none",document.getElementById("id-mainPage").style.display="block",document.getElementById("id-readRandom").style.display="block",document.getElementById("id-menu").style.display="block",void(searchOpen=!1);{document.getElementById("id-mainPage").style.display="none",document.getElementById("id-readRandom").style.display="none",document.getElementById("id-searchContainer").style.display="block",document.getElementById("id-menu").style.display="none",document.getElementById("id-searchBox").focus(),document.getElementById("id-searchVersion").textContent=document.getElementById(activeVersionID).textContent,document.getElementById("id-searchTop").scrollIntoView({block:"center"});let e=new URL(window.location);return window.history.pushState({},"",e),void(searchOpen=!0)}}function createIndex(e){const t={};return e.forEach((e=>{const n=e.vid;e.vt.split(/\W+/).forEach((e=>{const s=stemmer(e);t[s]||(t[s]=[]),t[s].push(n)}))})),t}function updateInvertedIndex(e,t){t.forEach((t=>{const n=t.vid;t.vt.split(/\W+/).forEach((t=>{if(!stopwords.has(t.toLowerCase())){const s=stemmer(t);e[s]||(e[s]=[]),e[s].includes(n)||e[s].push(n)}}))}))}function searchPhrase(e,t){const n=t.toLowerCase(),s=n.split(/\W+/),o=s.map((e=>stemmer(e))).map((t=>new Set(e[t]||[]))).reduce(((e,t)=>new Set([...e].filter((e=>t.has(e)))))),r=Array.from(o),d=r.filter((e=>verses.find((t=>t.vid===e)).vt.includes(t))),a=r.filter((e=>verses.find((t=>t.vid===e)).vt.toLowerCase().includes(n))),c=r.filter((e=>{const t=verses.find((t=>t.vid===e)).vt.toLowerCase();return s.every((e=>t.includes(e)))})),l=verses.filter((e=>{const t=e.vt.toLowerCase();return s.every((e=>t.includes(e)))})).map((e=>e.vid));return[...new Set([...d,...a,...c,...l])]}function setSearchChapter(e){let t,n,s=verses[e].bid,o=verses[e].cn,r=verses[e].vn;return s<40?(t=oldBooks.findIndex((e=>e.id===s)),n=oldBooks):(t=newBooks.findIndex((e=>e.id===s)),n=newBooks),`${n[t].t} ${o}:${r}`}function getSearchVerses(e=searchResults){let t,n,s,o,r,d,a=0,c=searchResultIndex+30,l=document.getElementById("id-searchResults");for(e.length-searchResultIndex<30&&(c=e.length);searchResultIndex<c&&c<=e.length;)n=document.createElement("p"),n.classList.add("cs-searchVerse"),t=document.createElement("a"),t.addEventListener("click",(()=>{getSearchChapter(),this.event.preventDefault(),this.event.stopPropagation(),this.event.stopImmediatePropagation()})),a=e[searchResultIndex]-1,t.id=`id-searchVerse${verses[a].vid}`,t.textContent=setSearchChapter(a),t.dataset.bid=verses[a].bid,t.dataset.cn=verses[a].cn,t.dataset.vn=verses[a].vn,t.classList.add("cs-searchChapter"),n.appendChild(t),r=document.createElement("br"),n.appendChild(r),d=verses[a].vt.replace("`",""),o=document.createTextNode(d),n.appendChild(o),l.appendChild(n),searchResultIndex++;s=document.createElement("hr"),l.appendChild(s),r=document.createElement("br"),l.appendChild(r);let i=e.length-searchResultIndex;0===i?(n=document.createElement("p"),n.textContent="There are no more results."):(t=document.createElement("a"),t.addEventListener("click",(()=>{getMoreResults(),this.event.preventDefault(),this.event.stopPropagation(),this.event.stopImmediatePropagation()})),t.textContent="More Results",t.classList.add("cs-searchResults"),l.appendChild(t),r=document.createElement("br"),l.appendChild(r),r=document.createElement("br"),l.appendChild(r),n=document.createElement("p"),n.textContent=`There are ${i} more results.`),l.appendChild(n),r=document.createElement("br"),l.appendChild(r),r=document.createElement("br"),l.appendChild(r)}function getMoreResults(){document.getElementById("id-loader").style.display="block",setTimeout((function(){getSearchVerses(),document.getElementById("id-loader").style.display="none"}),30)}function getSearchChapter(){let e=this.event.target.id,t=document.getElementById(e).dataset.bid,n=document.getElementById(e).dataset.cn,s=document.getElementById(e).dataset.vn;document.getElementById("id-MenuBtn4").textContent=s,activeBookID=`id-book${t}`,activeChapterID=`id-chapter${n}`,getChapter(),openSearch(),selectedVerseID=`id-versNumber${s}`;const o=document.getElementById(selectedVerseID),r=window.getSelection(),d=document.createRange();d.selectNodeContents(o),r.removeAllRanges(),r.addRange(d),o.scrollIntoView({block:"center"}),setQuerystring("vh",s)}async function testFetcher(){let e=document.getElementById("id-adjustTester"),t=document.getElementById("id-adjustTesterLabel");if(!e.value)return;if(verses)return verses=null,e.textContent="",void(t.textContent="Test Verses Index:");let n=Number(e.value);const s=await fetch(`data/${versions[n].ar}/${versions[n].ar}Verses.json`);verses=await s.json(),t.textContent=`Test Verses Index: ${n}: ${versions[n].ar}`;var o=document.getElementsByClassName("cs-activeVersion");o.length>0&&(o[0].id=versions[n].id,o[0].textContent=versions[n].t),activeVersionID=versions[n].id}async function searcher(){searchData=document.getElementById("id-searchBox").textContent,""!==searchData&&(document.getElementById("id-loader").style.display="block",setTimeout((function(){searchResultIndex=0,searchIndex||(searchIndex=createIndex(verses)),searchResults=searchPhrase(searchIndex,searchData),removeElements("id-searchResults"),getSearchVerses(searchResults),document.getElementById("id-loader").style.display="none"}),30))}